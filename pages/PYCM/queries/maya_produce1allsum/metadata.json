{
  "gitSyncId": "681837a3d01125478949ff12_5acf03a0-e890-4fff-9b4b-8feae0062812",
  "id": "PYCM_maya_produce1allsum",
  "pluginId": "mysql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT \n    `maya_produce2`.`dcode` AS `dcode`,\n    `maya_produce2`.`ddcode` AS `ddcode`,\n    `maya_produce2`.`ddname` AS `ddname`,\n    `maya_produce2`.`ddeng` AS `ddeng`,\n    `maya_produce2`.`dtype` AS `dtype`,\n    `maya_produce2`.`dpic` AS `dpic`,\n    `maya_produce2`.`dlo6` AS `dlo6`,\n    `maya_produce2`.`dlo3` AS `dlo3`,\n    `maya_produce2`.`dlo7` AS `dlo7`,\n    `maya_produce2`.`dlo4` AS `dlo4`,\n\n    -- รวม in_qtn จาก 3 สาขา\n    COALESCE(SUM(CASE WHEN `skreal` = 'พันท้าย' THEN `in_qtn` END), 0) +\n    COALESCE(SUM(CASE WHEN `skreal` = 'พระราม2' THEN `in_qtn` END), 0) +\n    COALESCE(SUM(CASE WHEN `skreal` = 'บางเลน17' THEN `in_qtn` END), 0) AS `in_qtn`,\n\n    -- รวม out_qtn จาก 3 สาขา\n    COALESCE(SUM(CASE WHEN `skreal` = 'พันท้าย' THEN `out_qtn` END), 0) +\n    COALESCE(SUM(CASE WHEN `skreal` = 'พระราม2' THEN `out_qtn` END), 0) +\n    COALESCE(SUM(CASE WHEN `skreal` = 'บางเลน17' THEN `out_qtn` END), 0) AS `out_qtn`,\n\n    -- Total คงเหลือแยกตามสาขา\n    COALESCE(SUM(CASE WHEN `skreal` = 'พันท้าย' THEN `total` END), 0) AS `sk1`,\n    COALESCE(SUM(CASE WHEN `skreal` = 'พระราม2' THEN `total` END), 0) AS `sk2`,\n    COALESCE(SUM(CASE WHEN `skreal` = 'บางเลน17' THEN `total` END), 0) AS `sk3`,\n\n    -- รวมคงเหลือทั้งหมดจากทั้ง 3 สาขา\n    COALESCE(SUM(CASE WHEN `skreal` = 'พันท้าย' THEN `total` END), 0) +\n    COALESCE(SUM(CASE WHEN `skreal` = 'พระราม2' THEN `total` END), 0) +\n    COALESCE(SUM(CASE WHEN `skreal` = 'บางเลน17' THEN `total` END), 0) AS `total`\n\nFROM \n    `maya_produce2`\n\nWHERE\n    `dcode`   LIKE CONCAT('%', {{Input2.text}}, '%') \n    OR `ddcode` LIKE CONCAT('%', {{Input2.text}}, '%') \n    OR `ddname` LIKE CONCAT('%', {{Input2.text}}, '%') \n\nGROUP BY \n    `maya_produce2`.`dcode`,\n    `maya_produce2`.`ddcode`,\n    `maya_produce2`.`ddname`,\n    `maya_produce2`.`ddeng`,\n    `maya_produce2`.`dtype`,\n    `maya_produce2`.`dpic`,\n    `maya_produce2`.`dlo6`,\n    `maya_produce2`.`dlo3`,\n    `maya_produce2`.`dlo7`,\n    `maya_produce2`.`dlo4`\n\nORDER BY \n    `maya_produce2`.`ddname` DESC;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "2020",
      "isAutoGenerated": false,
      "name": "2020",
      "pluginId": "mysql-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": false,
    "name": "maya_produce1allsum",
    "pageId": "PYCM",
    "userSetOnLoad": true
  }
}