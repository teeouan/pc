select `maya_produce2`.`dcode` AS `dcode`,`maya_produce2`.`ddcode` AS `ddcode`,`maya_produce2`.`ddname` AS `ddname`,`maya_produce2`.`ddeng` AS `ddeng`,`maya_produce2`.`dtype` AS `dtype`,`maya_produce2`.`dpic` AS `dpic`,`maya_produce2`.`dlo6` AS `dlo6`,`maya_produce2`.`dlo3` AS `dlo3`,`maya_produce2`.`dlo7` AS `dlo7`,`maya_produce2`.`dlo4` AS `dlo4`,coalesce(sum(case when `maya_produce2`.`skreal` = 'พันท้าย' then `maya_produce2`.`in_qtn` end),0) + coalesce(sum(case when `maya_produce2`.`skreal` = 'พระราม2' then `maya_produce2`.`in_qtn` end),0) + coalesce(sum(case when `maya_produce2`.`skreal` = 'บางเลน17' then `maya_produce2`.`in_qtn` end),0) AS `in_qtn`,coalesce(sum(case when `maya_produce2`.`skreal` = 'พันท้าย' then `maya_produce2`.`out_qtn` end),0) + coalesce(sum(case when `maya_produce2`.`skreal` = 'พระราม2' then `maya_produce2`.`out_qtn` end),0) + coalesce(sum(case when `maya_produce2`.`skreal` = 'บางเลน17' then `maya_produce2`.`out_qtn` end),0) AS `out_qtn`,coalesce(sum(case when `maya_produce2`.`skreal` = 'พันท้าย' then `maya_produce2`.`total` end),0) AS `sk1`,coalesce(sum(case when `maya_produce2`.`skreal` = 'พระราม2' then `maya_produce2`.`total` end),0) AS `sk2`,coalesce(sum(case when `maya_produce2`.`skreal` = 'บางเลน17' then `maya_produce2`.`total` end),0) AS `sk3`,coalesce(sum(case when `maya_produce2`.`skreal` = 'พันท้าย' then `maya_produce2`.`total` end),0) + coalesce(sum(case when `maya_produce2`.`skreal` = 'พระราม2' then `maya_produce2`.`total` end),0) + coalesce(sum(case when `maya_produce2`.`skreal` = 'บางเลน17' then `maya_produce2`.`total` end),0) AS `total` from `maya_produce2` group by `maya_produce2`.`dcode` order by `maya_produce2`.`ddname` desc